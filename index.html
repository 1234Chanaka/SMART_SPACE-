<<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SMART SPACE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --blue:#0d47a1;
  --dark:#081624;
  --gold:#fbc02d;
  --light:#eaeff5;
}

body{
  margin:0;
  font-family:Arial, sans-serif;
  background:url("https://static.vecteezy.com/system/resources/previews/001/882/531/original/dark-blue-technology-background-free-vector.jpg") center/cover fixed;
  color:var(--gold);
  min-height:100vh;
}

h1{
  margin:15px 0;
  text-align:center;
  font-size:1.4rem;
}

/* LOGIN */
#loginForm{
  max-width:360px;
  margin:70px auto;
  background:rgba(8,22,36,0.95);
  padding:25px;
  border-radius:14px;
  border:1px solid var(--gold);
}

#loginForm input{
  width:100%;
  padding:12px;
  margin:10px 0;
  border-radius:10px;
  border:1px solid var(--gold);
  background:#0e2238;
  color:#fff;
}

#loginForm button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  background:linear-gradient(135deg,var(--gold),#c49000);
  font-weight:bold;
  cursor:pointer;
}

/* DASHBOARD */
#dashboard{ display:none; }

.relay-container{
  max-width:420px;
  margin:10px auto;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.relay-card{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:rgba(8,22,36,0.9);
  padding:14px 16px;
  border-radius:14px;
  border:1px solid var(--gold);
}

.relay-card h2{
  margin:0;
  font-size:0.9rem;
}

.relay-card span{
  font-size:0.8rem;
  color:var(--light);
}

.relay-card button{
  padding:8px 14px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,#1976d2,var(--blue));
  color:var(--gold);
  font-size:0.75rem;
  cursor:pointer;
}

#logoutBtn{
  display:block;
  margin:20px auto;
  padding:10px 18px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,var(--gold),#c49000);
  font-weight:bold;
  cursor:pointer;
}

footer{
  text-align:center;
  font-size:0.7rem;
  margin:15px 0;
  color:var(--gold);
}
</style>
</head>

<body>

<h1>SMART SPACE</h1>

<!-- LOGIN -->
<div id="loginForm">
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button id="loginBtn">LOGIN</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard">
  <div class="relay-container">

    <div class="relay-card">
      <div>
        <h2>LOCK</h2>
        <span id="status1">--</span>
      </div>
      <button id="btn1"></button>
    </div>

    <div class="relay-card">
      <div>
        <h2>ENGINE</h2>
        <span id="status2">--</span>
      </div>
      <button id="btn2"></button>
    </div>

    <div class="relay-card">
      <div>
        <h2>PARKING LIGHT</h2>
        <span id="status3">--</span>
      </div>
      <button id="btn3"></button>
    </div>

  </div>

  <button id="logoutBtn">LOGOUT</button>
</div>

<footer>Created by CHANAKA</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyD0YRMfJeLWRbRhTz6sVldri0sWrA7xtKQ",
  authDomain:"esp32--relay-control.firebaseapp.com",
  databaseURL:"https://esp32--relay-control-default-rtdb.europe-west1.firebasedatabase.app"
});

const allowedEmail="abijayasinghe@gmail.com";
const allowedPassword="ABI12340";

const loginForm=document.getElementById("loginForm");
const dashboard=document.getElementById("dashboard");

document.getElementById("loginBtn").onclick=()=>{
  const e=email.value,p=password.value;
  if(e===allowedEmail && p===allowedPassword){
    firebase.auth().signInWithEmailAndPassword(e,p).then(()=>{
      loginForm.style.display="none";
      dashboard.style.display="block";
      start();
    });
  }else alert("Invalid login");
};

function start(){
  const db=firebase.database();

  const relays=[
    {name:"LOCK", id:1},
    {name:"ENGINE_OFF", id:2},
    {name:"PARKINGLIGHT_ON", id:3}
  ];

  const labels={
    LOCK:{on:"LOCK",off:"UNLOCK",btnOn:"LOCK",btnOff:"UNLOCK"},
    ENGINE_OFF:{on:"ENGINE OFF",off:"ENGINE ON",btnOn:"ENGINE OFF",btnOff:"ENGINE ON"},
    PARKINGLIGHT_ON:{on:"LIGHT ON",off:"LIGHT OFF",btnOn:"LIGHT ON",btnOff:"LIGHT OFF"}
  };

  relays.forEach(r=>{
    const status=document.getElementById("status"+r.id);
    const btn=document.getElementById("btn"+r.id);
    const ref=db.ref("/"+r.name);

    ref.on("value",s=>{
      const on=s.val();
      const c=labels[r.name];
      status.innerText=on?c.on:c.off;
      btn.innerText=on?c.btnOn:c.btnOff;
    });

    btn.onclick=()=>ref.get().then(s=>ref.set(!s.val()));
  });
}

logoutBtn.onclick=()=>{
  firebase.auth().signOut();
  dashboard.style.display="none";
  loginForm.style.display="block";
};
</script>

</body>
</html>

